<!DOCTYPE html>
<html>
<head>
  <title>Weather Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Temperature and Humidity (Past & Future 24h)</h1>
  <div style="width: 50vw;">
    <canvas id="comboChart"></canvas>
  </div>
  <script>
    async function fetchData(url) {
      const res = await fetch(url);
      return res.json();
    }

    async function drawComboChart() {
      const history = await fetchData('/api/history');
      const forecast = await fetchData('/api/forecast');

      const histLabels = history.map(d => d.timestamp);
      const histTemps = history.map(d => d.temperature);
      const histHumids = history.map(d => d.humidity);

      const foreLabels = forecast.map(d => d.timestamp);
      const foreTemps = forecast.map(d => d.temperature);
      const foreHumids = forecast.map(d => d.humidity);

      const labels = histLabels.concat(foreLabels);
      const temps = histTemps.concat(foreTemps);
      const humids = histHumids.concat(foreHumids);

      new Chart(document.getElementById('comboChart'), {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'Temperature (°F)',
              data: temps,
              borderColor: 'red',
              yAxisID: 'y1',
              fill: false
            },
            {
              label: 'Humidity (%)',
              data: humids,
              borderColor: 'blue',
              yAxisID: 'y',
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          stacked: false,
          scales: {
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: { display: true, text: 'Humidity (%)' }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: { display: true, text: 'Temperature (°F)' },
              grid: { drawOnChartArea: false }
            }
          }
        }
      });
    }
    drawComboChart();
  </script>
</body>
</html> 